<%
require "ez_crud/attrs"
require "ez_crud/html"
attrs = EzCrud::Attrs.summarize(model_class, local_assigns.fetch(:params, {}))
attr_types = EzCrud::Attrs.attr_types(model_class)
%>
<div class="index-container">
  <table class="index-table">
    <thead>
      <tr>
        <% attrs.each do |attr| %>
          <th><%=I18n.t(attr, default: attr.to_s.titleize)%></th>
        <% end %>
        <th></th>
      </tr>
  </thead>
    <tbody>
      <% models.each do |model| %>
        <tr>
          <% attrs.each do |attr| %>
            <td class="<%=attr_types[attr]%>">
              <%= EzCrud::Html.show(model.send(attr)) %>
            </td>
          <% end %>
          <td>
            <% if viewable?(model) %>
              <%= link_to I18n.t("ez_crud.show"), model, class: "button show-button" %>
            <% end %>
            <% if editable?(model) %>
              <%= link_to I18n.t("ez_crud.edit"), send("edit_#{model_class.name.underscore}_path".to_sym, model), class: "button edit-button" %>
            <% end %>
            <%if destroyable?(model) %>
              <%= link_to I18n.t("ez_crud.destroy"), model, method: :delete, class: "button destroy-button", data: { confirm: 'Are you sure?' } %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <% if local_assigns.fetch(:paged, true) %>
    <%= render 'components/ez_crud/paginator', search: search, model_class: model_class %>
  <% end %>
</div>
